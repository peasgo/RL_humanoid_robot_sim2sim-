# configs/v4_robot.yaml
# V4 Quadruped Robot - Sim2Sim MuJoCo Configuration
# 适配新策略：obs=62, actions=16 (排除Waist_2)

policy_path: "/home/rl/RL-human_robot/IsaacLab/logs/rsl_rl/v4_quadruped_flat/2026-02-10_15-49-36/exported/policy.pt"
xml_path: "v4_scene.xml"

# 仿真时长与步长
simulation_duration: 1000.0
simulation_dt: 0.005
control_decimation: 4


# Waist_2: kp=1000, kd=100 (锁定在π)
# legs (SD/ARM/HIP/KNEE): kp=150, kd=15, effort_limit=150
# ankle (ANKLE): kp=120, kd=12, effort_limit=120
#
# MuJoCo顺序: Waist_2, RSDp, RSDy, RARMp, RARMAP,
#              LSDp, LSDy, LARMp, LARMAp,
#              RHIPp, RHIPy, RKNEEP, RANKLEp,
#              LHIPp, LHIPy, LKNEEp, LANKLEp
kps: [1000,
      150, 150, 150, 150,
      150, 150, 150, 150,
      150, 150, 150, 120,
      150, 150, 150, 120]

kds: [100,
      15, 15, 15, 15,
      15, 15, 15, 15,
      15, 15, 15, 12,
      15, 15, 15, 12]


# Waist_2=π, RSDp=0.7854, RSDy=0, RARMp=-1.5708, RARMAP=0.7854,
# LSDp=0.7854, LSDy=0, LARMp=1.5708, LARMAp=0.7854,
# RHIPp=0.7854, RHIPy=0, RKNEEP=1.5708, RANKLEp=-0.7854,
# LHIPp=-0.7854, LHIPy=0, LKNEEp=-1.5708, LANKLEp=-0.7854
default_angles: [3.14159,
                 0.7854, 0.0, -1.5708, 0.7854,
                 0.7854, 0.0, 1.5708, 0.7854,
                 0.7854, 0.0, 1.5708, -0.7854,
                 -0.7854, 0.0, -1.5708, -0.7854]


lin_vel_scale: 1.0
ang_vel_scale: 1.0
dof_pos_scale: 1.0
dof_vel_scale: 1.0
action_scale: 0.5

use_tanh_action: false


action_clip: 5.0  # 从100降到5.0，限制极端动作输出（正常动作范围在±2以内）


action_filter_alpha: 0.3  # 从0.2提高到0.3，部署端适度平滑


obs_filter_alpha: 0.3  # 从0.7降到0.3，减少观测延迟（重训后策略更平滑，不需要重滤波）
# obs_filter_mode: "all"=全部滤波, "vel_only"=只滤速度类(更自然)
obs_filter_mode: "vel_only"


action_ramp_steps: 50  # 从25增加到50，更缓慢的启动避免初始冲击

# 质量缩放: 等比增加所有body的mass和inertia
# V4机器人太轻(2.68kg), MuJoCo软接触弹跳严重
# 5x=13.4kg 接近Go2(12kg), 空中率从42%降到6%
mass_scale: 5.0

dq_sign_fixes: null
cmd_scale: [1.0, 1.0, 1.0]


num_actions: 16
num_obs: 62


cmd_init: [-0.0, 0.0, 0.0]

v4_coordinate_remap: true


