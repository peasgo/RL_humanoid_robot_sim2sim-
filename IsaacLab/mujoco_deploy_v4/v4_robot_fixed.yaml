# V4 Quadruped Robot - Corrected Sim2Sim MuJoCo Configuration
# 针对训练 2026-02-11_12-17-13 的策略
# 关键修正：
#   1. action_scale = 0.25 (与训练一致，之前错误地用了0.5)
#   2. 去除所有band-aid (mass_scale, action_filter, obs_filter, action_ramp)
#   3. 使用正确的关节顺序（MuJoCo顺序 = IsaacLab内部顺序）
#   4. 默认角度与训练env.yaml完全一致

policy_path: "/home/rl/RL-human_robot/IsaacLab/logs/rsl_rl/v4_quadruped_flat/2026-02-11_12-17-13/exported/policy.pt"
xml_path: "v4_scene.xml"

# 仿真参数 — 与训练完全一致
simulation_duration: 1000.0
simulation_dt: 0.005       # 200Hz, 与训练 sim.dt=0.005 一致
control_decimation: 4      # 50Hz策略频率, 与训练 decimation=4 一致

# PD增益 — MuJoCo顺序 (17关节)
# MuJoCo顺序: Waist_2, RSDp, RSDy, RARMp, RARMAP,
#              LSDp, LSDy, LARMp, LARMAp,
#              RHIPp, RHIPy, RKNEEP, RANKLEp,
#              LHIPp, LHIPy, LKNEEp, LANKLEp
kps: [1000,
      150, 150, 150, 150,
      150, 150, 150, 150,
      150, 150, 150, 120,
      150, 150, 150, 120]

kds: [100,
      15, 15, 15, 15,
      15, 15, 15, 15,
      15, 15, 15, 12,
      15, 15, 15, 12]

# 默认角度 — MuJoCo顺序, 与训练env.yaml完全一致
# Waist_2=π, RSDp=0.7854, RSDy=0, RARMp=-1.5708, RARMAP=0.7854,
# LSDp=0.7854, LSDy=0, LARMp=1.5708, LARMAp=0.7854,
# RHIPp=0.7854, RHIPy=0, RKNEEP=1.5708, RANKLEp=-0.7854,
# LHIPp=-0.7854, LHIPy=0, LKNEEp=-1.5708, LANKLEp=-0.7854
default_angles: [3.14159,
                 0.7854, 0.0, -1.5708, 0.7854,
                 0.7854, 0.0, 1.5708, 0.7854,
                 0.7854, 0.0, 1.5708, -0.7854,
                 -0.7854, 0.0, -1.5708, -0.7854]

# 观测缩放 — 训练中没有额外缩放(scale=1.0)
lin_vel_scale: 1.0
ang_vel_scale: 1.0
dof_pos_scale: 1.0
dof_vel_scale: 1.0

# ★ 关键修正: action_scale = 0.25 (训练env.yaml确认)
action_scale: 0.25

# 不使用tanh
use_tanh_action: false

# clip范围 — 训练中 clip_actions 未设置(null), 用较宽的范围
action_clip: 100.0

# ★ 去除所有band-aid — 参考humanoid-gym的做法，不加任何滤波
action_filter_alpha: 0.0
obs_filter_alpha: 0.0
obs_filter_mode: "all"
action_ramp_steps: 0

# ★ 去除质量缩放 — 如果物理不匹配应该修XML，不应该hack质量
mass_scale: 1.0

dq_sign_fixes: null
cmd_scale: [1.0, 1.0, 1.0]

num_actions: 16
num_obs: 62

cmd_init: [0.4, 0.0, 0.0]

v4_coordinate_remap: true
